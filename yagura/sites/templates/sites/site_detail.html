{% extends 'layouts/two_pane.html' %}
{% load i18n %}
{% load bulma_tags %}

{% block content_main %}
  <div class="level">
    <h1 class="title">{% trans 'Site detail' %}</h1>
    <a class="button is-danger is-small is-pulled-right" href="{% url 'sites:delete' site.id %}">Delete</a>
  </div>

  {# TODO: Refactor struct of site information #}
  <table class="table">
    <tbody>
      <tr>
        <th>{% trans 'Site URL' %}:</th>
        <td><a href="{{ site.url }}" target="_blank">{{ site.url }}</a></td>
      </tr>
      <tr>
        <th>{% trans 'Excepted HTTP status code' %}:</th>
        <td>{{ site.ok_http_status }}</td>
      </tr>

      <tr>
        <th>Email notifications:</th>
        <td>
          <span class="buttons has-addons are-small">
            <a class="button" href="{% url 'notifications:list-email-recipient' site.id %}">Show</a>
            <a class="button" href="{% url 'notifications:add-recipient' site.id %}">Add</a>
          </span>
        </td>
      </tr>
      <tr>
        <th>Slack notifications:</th>
        <td class="buttons has-addons are-small">
          <a class="button" href="{% url 'notifications:list-slack-recipient' site.id %}">Show</a>
          <a class="button" href="{% url 'notifications:add-slack-recipient' site.id %}">Add</a>
        </td>
      </tr>
    </tbody>
  </table>
  <div>
    <h3>History</h3>
    <table class="table is-striped is-fullwidth">
      <thead>
        <tr>
          <th>{% trans 'State' %}</th><td>{% trans 'Range' %}</td><td>{% trans 'Reason' %}</td>
        </tr>
      </thead>
      <tbody>
        {% for history in site.states.all reversed %}
        <tr>
          <td>{{ history.state }}</td>
          <td>{{ history.begin_at }} - {{ history.updated_at }} {% if forloop.first %}(now){% endif %}</td>
          <td>{{ history.reason }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
